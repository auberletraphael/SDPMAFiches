#To edit and compare internal_properties, use WINDEV integrated tools.
#Internal properties refer to the properties of controls in windows, reports, etc.
info :
 name : FEN_Principale
 major_version : 26
 minor_version : 0
 type : 2
 description : ""
 subtype : 0
window :
 name : FEN_Principale
 identifier : 0x2f07ea590076f92d
 internal_properties : BgAAAAYAAABwc5vJHIqBYJUJlQygFXh2csLc71Cqr0A6clQjtXon0We6aITuwR5oTU02FqtMJet1q+tAH4sCjtI0eoT9WFup2cB9ZkdEAmNN1usqc/17iiu//Wo3cLsNjvIGjM0JXhXYgV21s8w+dXu3/rBAQeCB1gG3/qSJErrkQmy/SLFZdWBx6izpq4y78BUvjBQ/G7QmNW9O/2L1vmrpiJMaXrQIqmDE3j+0H2OpQV5+44MRJqywtT05zwt5H9xE3DrePlWY8jWOpnu224D9lrPefGUyMFm0gKbReZWqIFI1Qd1yU4Wqlt0uGe/tyrUkyTaumyAbhUFEmaG6p0C0stBfFx4S33uNOBQPrSAr0c80EX4yIUTBUtISI+kVh4l9HVTBxSogxvY++7b3aMgePRYHGihBaHLb+MWxFf9KFjnc9EQg7my1oKfJPu+n6RGZuCWPWpMKXumL7+7/qkYmcunpPYY8hLWMC+MRnQLlxyUyc51hzNzMxBcBPOPtHWGxYC9fyk4yX7eqZenSd//KK2u+nryM/0s5NklvLa685Mdg+8hcYz2sAScMqJz+Mdn5pCzVAje7SkkgRIEVWQv4vu4vj7unMNxewIYUDEl7dG8qrcslE/T4sC2uAtxEiYUwpa4vbcvydqdmaOhYm3XdTNE3N0bj+sg3JXk1vIpZxX7//BzZBdQ=
 controls :
  -
    name : BTN_Importer
    identifier : 0x2f07eb9d0192ebc7
    internal_properties : BgAAAAYAAAAN6AAc2olnlaTyAz1rykdwnFrMxsJXbBJoJQFmTSa1FF+b4he6WVeyZBvJMUsC8yV3vInpNFpZRChlskjnrZek9DqwHOszIuEDaBRYshIU3X7zi4smz18lB1MM3edzBJCj40UgfLqqc4gxlrMKH3FDLJHDebKvCcIIectEuFpNOF8Qtu/s19XlZw7BH0jOAtMOW49sTAMB6ylTkji1oH6Toou44coC41yZlZ7TidTfqab57AzgQaAJPuiJG1nxFC3SNLU6+3D3hb+paM4fxd9+hOGf2kGhYPQWcs12EAbrEEXDHZzK94ZXkWLx1ZQuerOVVxPZ+OSz/z+buDVxeYx3UzerMxShqCitDDONFccDOF2JWvDvKqZFfVD+mCoJTEysV/ZuAIWabkYLZjI8XrqvmpWqUaxp59KTwvTjiTYFIiXHRylOSNvalChbtzUMfwprm7OkgPCjJvr/m3Fy4sBHndrBUjEGY8sVZ0ZWWSVzUHC2Ber7803M7goMWXgq895Pj7ovfG8ep1wMw0I/XCWBeTx9XyEHLnJejY0geZIx4Od3TLrtyNmdOk0KIkiTdklM4Jkuk2a8fTMwzrN4QzYaGtZvv5kT+c5l/BUWiL9G5NNKkfetSJEQm39mKNiu43PtP6puNBrOw+9RYfd5ibnVKm611TgOMOKWbSiYewldhoaWVuzOSnQLyEnk7JvV1ZGNaMBao3zyzA+RU2cHDbK1HgCIM2ntVedhizK7uxy2cNeelADUUMSeVny//Z5JK8eY2zWYXy9gsDIQmeyaVcr9W1ukYf3c+YHnABxzvAQmxkFjzhR/l12on+DDVD9fqmwF0/QUC+D7kYHXk7XhJwmOJ5i9fQ10BQa7UmWRBGkwmoDoSKWkARkjThhMpsX8QDjp
    type : 4
    code_elements :
     type_code : 4
     p_codes :
      -
        code : |1+
         // Version 1
         // Description 
         // Bouton au style Nouveau pour ajouter ou créer des éléments
         
         
        type : 14
      -
        code : |1+
         //V1
         
         //sFichier est une chaine
         //sFichier = fSélecteur("", "", "Sélectionnez un fichier Excel...", "Fichier Excel" + TAB + "*.xls;*.xlsx", "*.xls;*.xlsx")
         
         
         // TableurCharge(TBLR_Tableur,fRepEnCours() + "\fichiers\Fiche_Import_Animalerie.xlsx",1)
         
         sCheminFichier est une chaine = chercheExcel()
         
         si sCheminFichier <> "" ALORS
         	ouvreExcel(sCheminFichier)
         	SAI_Fichierencour = sCheminFichier
         FIN
         
         //V2
         //sFichier est une chaine
         //sFichier = fSélecteur("", "", "Sélectionnez un fichier Excel...", "Fichier Excel" + TAB + "*.xls;*.xlsx", "*.xls;*.xlsx")
         //
         //clMonexcel est un CDocumentXls(sFichier,TBLR_Tableur..NomComplet)
         //
         //gpclMonFichierExcel = clMonexcel
         //
         //gsCheminFichier = gpclMonFichierExcel:ouvreXls()
         //
         //SAI_Fichierencour = gsCheminFichier
         
         
         
         
         
         
         
         
        type : 18
      -
        type : 161
        enabled : false
  -
    name : TBLR_Tableur
    identifier : 0x2f07ebbd02166627
    internal_properties : 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
    columns : []
    type : 114
    code_elements :
     type_code : 137
     p_codes :
      -
        code : |1-
         
         si SAI_Fichierencour <> "" ALORS
         	TableurSauve(TBLR_Tableur,SAI_Fichierencour,tblrEcrasementAutorisé)
         FIN
        type : 258
  -
    name : BTN_Imprimer1
    identifier : 0x2f118e7101bb8db5
    internal_properties : BgAAAAYAAABhHxlpt+lDa8kxo8XPDZvuZuIQWP9skxbELyiTnpIQarKtzbPdPT6/sNfddQGfvzqcntzV6sYrPfuQJRtFArdf4OoBExwMpN93h9pwGk34ZF5aHd8SGEqwTngYf46c6WJ/+d/Dl5+QhPciHxrktbeuAEe4+TDuEZ3w4P6Dx1FOYWIqvG8DaGMc3fzUPpszW/oiZXgrCTkLZpbyhhGzYJd9zqhEPUBhAIoil7ZsApMIrCd47rDG2EzA5/FHW4RI8vCqbqu4SYOrCs0X25zgChXUnKgWY6ibd27COpEa1GAwg5BDm0WkTkFP0Ly7bbiBhWhSyY7QOOP0EgjkkIOhOKthed9ibkryRVAvLOvv/niy4U2IsKuXAZA3Z06saTXorGQe5kkBlgwaQG3u6ElbUbNpHt5VwW8jIsY37WMks6v6b308WzXaOhKBnyiNPBtm+SBvonCIN8rHPuhChRBTefS38Z2btX87ftotqHqFHQHThrFiErxidH3UUfe3m5tTVOTlGIB5LCCFFxaWnKBuxaFC8/Hy+4SGz66ivDJA5vupuWvnFcCjuVYa3qGF1LE9KAIgF/UzTpS4v4uc+9FI3qMcpQ6Ap6oRRbAb2LCEGHBPsQ6Z07L0Q2JmdRmhpPJoNxcKkx+bAPS7YBrBtFKsw2Z3pKKQoIsZMZZuORN4tVNm72NNc8nawkBFCSOUpHjcpTAzR61g5IJzeJ8ba2qoXhs7vCexsWKezztwN/00p+q1oOu5Il9PnByZJv5d5PtmqLnC5k0Adg8wKiWAlw43IdPZEu239VIVicloirdM2QgOzQ==
    type : 4
    code_elements :
     type_code : 4
     p_codes :
      -
        code : |1+
         // Version 1
         // Description 
         // Bouton au style imprimer
         
         
        type : 14
      -
        code : |1+
         numligne est un entier
         
         nRetoursaisie est un entier = Saisie("Quelle ligne voulez vous imprimer ? Tapez 0 pour tout générer",numligne)
         
         
         selon gnTypeFiche
         	cas 1 // 1 Végétaux
         		 //info("En cours")
         		// tableur vers excel
         		tableurVersFichier(numligne)
         		
         		iDestination(iVisualisateur)
         		iImprimeEtat(Catalogue_Fiche_Végétaux,gsCheminFichier+"Images\")
         		
         	cas 2 // Animaux
         		
         		// tableur vers excel
         		tableurVersFichier(numligne)
         
         		//Lancer l'ETAT_impression
         		iDestination(iVisualisateur)
         		iImprimeEtat(Catalogue_fiche,gsCheminFichier+"Images\")
         		
         	cas 3
         		// tableur vers excel
         		tableurVersFichier(numligne)
         		
         		//Lancer l'ETAT_impression
         		iDestination(iVisualisateur)
         		iImprimeEtat(Catalogue_Fiche_Animaux_APEX,gsCheminFichier+"Images\")
         		
         	AUTRE CAS
         		
         FIN
         
         
         procédure interne récupèreligne()
         	tableauChaine est un tableau de chaîne
         	
         	
         	tableauChaine = TableurRécupèreSélection(TBLR_Tableur)
         	sChaineUnique est une chaîne = tableauChaine[1]
         	
         	sChaineUnique = SansCaractère(sChaineUnique,"ABCDEFGHIJKLMNOPQRSTUVWXYZ",sscTout)
         	
         	nUmligneSelect est un entier = Val(sChaineUnique)
         FIN
         
         
         
         
         
         
         
         
         
         
         
         
         
         
        type : 18
      -
        type : 161
        enabled : false
  -
    name : BTN_Valider
    identifier : 0x2f1193a701d2e6c1
    internal_properties : BgAAAAYAAABkrzj0vObAn/RGYablgU7Shx8ykxlDUcnpdPI4+I+6Y43bCxU8m+v+RoVWPvdtjDsZiiUv9w++QT0vokTp8JtgOC0vWoDkUGsJELMGHVbjpXD1LtJLdm42Xh1GwAoiUS3yF1mP+Sy6XCMcTgfRGiwAaKxhy9TE20O3ewz6A9LyfSYg9thRfWEXxqmgNdVlrEtdQ0xtZQPkaK0MyRxM8HRONWnchdYiRthAo0RUPUesEaf9H1OJ1seGG5qXgif8/RA20QGWg7z/bIfL63LMolIw9ARQYgxOD1D1+TXNKQyneuFbHjCjFvMzmEJbF7qxvC9eiwGRrf/egtX0uhd+3irgCgRgMNjXxWYJ/VLYadoYQ4NmAPF1MdDzDXqwF+fJ9OwbQZtDZCWa3ahAkqmGBRW9qZGrk9qpfkscsDsBeiWBsOF4M+mDpSwSmxzKhB10G77hDK5WQ8FBfJldUNMEgC4ARFrzzNdaoEm7+MwUtdR5/kkPtxoFZXaLHH6LBwJAeeOh39o1Gr+tG1/Z+ggf1tmyF61wx78wOPFfFQapE8IfEeBb3joi1PgM6dgCxAMsPRFOEvMiX34RmWqoAUaw/XRBEP04yiPeajOWnntVoIlgZNaKJz4tT7EiWGevMgPs7hL0ZwkFt9QTes7SG47AwNQjSXnTnGbk3lbkic7lK9E6XXXZDunPuzvv8KtwVDWAkioU5AbcNpahTXoWQnPdF1JqRZ+JwaMlqBEIUSO+sSnWiAJ1nkFeurqag58zkKQNO7SZPCejTJ2O58dC+AIGdGzyaVZ59fwRN5hZNQpcPAV/bWIwt/n1phKV6IgSB6fReGIH395kCwMxkgIMPGkEUKBxIh1S1cv6Rm6opy7Dp0Funa1eUVBgzUwLicsT4P2fDP5Ux20jGp26XPNai0ZSh+K7mmY5f4IKQ0J+X9jBwiWHkuaPx8tima/vljsB2GMtEargXe+q8jfNKURDXnTypCdITMwSTF4RONXQ93K5JRq6CGBlsfbPiY1vN9+wYCi1e4QAtOvYhmQUmI0JTrrY20sQHGqqiq+yfLSamOUu+DY6kIBPU/dD
    type : 4
    code_elements :
     type_code : 4
     p_codes :
      -
        code : |1+
         // Version 1
         // Description 
         // Bouton en validation
         
        type : 14
      -
        code : |1+
         tableauChaine est un tableau de chaine
         
         
         tableauChaine = TableurRécupèreSélection(TBLR_Tableur)
         sChaineUnique est une chaîne = tableauChaine[1]
         
         sChaineUnique = SansCaractère(sChaineUnique,"ABCDEFGHIJKLMNOPQRSTUVWXYZ",sscTout)
         
         numLigne est un entier = val(sChaineUnique)
         
         sNomimage est une chaîne
         
         
         si numLigne <> 0 et numLigne <> 1 ALORS
         	chainerecherche est une chaine = TBLR_Tableur["A"+numLigne]
         	sNomimage = Ouvre(FEN_Recherche_d_Image,chainerecherche,gsCheminFichier)
         sinon
         	sNomimage = Ouvre(FEN_Recherche_d_Image,"",gsCheminFichier)
         FIN
         
         si sNomimage <> "" ALORS
         	
         	// SELON LA FICHE
         	selon gnTypeFiche
         		cas 2 // Fiche Animaux
         			ajouteImage("O")
         		cas 1 // Fiche Végétaux
         			ajouteImage("N")
         		cas 3 // Fiche Animaux V2
         			ajouteImage("P")
         		AUTRE CAS
         			
         	FIN
         	
         	
         	
         	
         	// FIN DE CAS FICHE
         	
         	
         
         	
         FIN
         
         procédure interne ajouteImage(sColonneimage est une chaine)
         	TBLR_Tableur[sColonneimage + numLigne] = sNomimage
         	// TEST
         	
         	sMonimagemin est une chaîne = ChaîneSupprime(sNomimage,".jpg")
         	
         	//trace(sMonimagemin)
         	
         	sMonimagemin += "_min.jpg"
         	
         	//trace(sMonimagemin)
         	
         	TBLR_Tableur..HauteurLigne = 200
         	
         	//TableurAjouteImage(TBLR_Tableur,gsCheminFichier+"Images\" + sMonimagemin,sColonneimage + numLigne)
         	SI SAI_Fichierencour <> "" ALORS
         		TableurSauve(TBLR_Tableur,SAI_Fichierencour,tblrEcrasementAutorisé)
         		
         		
         		SI OuiNon("Voulez-vous Visualiser la fiche ?") ALORS
         			SELON gnTypeFiche
         				CAS 1 // 1 Végétaux
         					//info("En cours")
         					// tableur vers excel
         					tableurVersFichier(numLigne)
         					
         					iDestination(iVisualisateur)
         					iImprimeEtat(Catalogue_Fiche_Végétaux,gsCheminFichier+"Images\")
         					
         				CAS 2 // Animaux
         					
         					// tableur vers excel
         					tableurVersFichier(numLigne)
         					
         					//Lancer l'ETAT_impression
         					iDestination(iVisualisateur)
         					iImprimeEtat(Catalogue_fiche,gsCheminFichier+"Images\")
         					
         				AUTRE CAS
         					
         			FIN
         		FIN
         		
         	FIN
         FIN
         
         
         //
         //pour TOUT sChaineUnique de tableauChaine
         //	info(sChaineUnique)
         //FIN
         
        type : 18
      -
        type : 161
        enabled : false
  -
    name : SAI_Fichierencour
    identifier : 0x2f15138f0220c251
    internal_properties : BgAAAAYAAADlttpz2aN5e+HdGMS/Jl2SIFT2tmCjkIebSkvW1kdccqo3suAaQxKLF8K9YHh2PszcbRC+lqw2Q2b27q6205EEldtXS7e5Kt0hZNuAqWUdvQAilpu26dKLfpqkS2MMTeJAVMtqTwNhfXaOsfaCyWgykr8Pte2MGsa6Ue57c8eIDIEhR7cWJe/7JgKcxnxhSsEnZhS720h4kWEBXYg8R6E81OZmAw08iaT5v8WmXbrEab1d6eMo+wBFyEV/73ZYnKUHhHa0oHYzqxvBP5oiiHpHXukd0mxb29tJp0kz3tGftxcu6y/0t9vabC2RlnTddW5kXAH9C75zjoeuNh2KUU8aAFk0n88IHAfe8VnjnGNU9iBcHRPjTHy5kFwHdXDe1RPKbAuuwAuyfAsBtG3LBT0SaJlZFetzplbWZJqevx0NCN1C9OjPSt6nZtgej+1ymJZ2pKPg46RTX5+Sd8eNWLVVWagYLSLLazMpJBokWigeZ5bGpSKkFCM2MGKvjQUl92NPXXEvy4PhCoiv5GDSUx0Uf7vTjrPZBghl6IrLmIvxq4xvdgzaiUP1j6qI+7ueSUCBW8ODJ4ZrKe29Duyo5W8LjUZANM65QrJ/8y7h47gtoI9kS1oDWQs5cPC6elKTGnJcV3CGZqHVUKov+WKer7XSewcbN2IjhOD5JQG2PTqEgTzRP9YPXZ32yQ/rE3Vh8ohApHnArUjkQuy24GJUz+lLflCu0TcrnVMIxEZIkHKQjl8JwK4DjiYufGY+zU2Pl+KjxrdHkIK9cE4bOTZkMyohUtXFoeiMYcE5pTMFleyqeGO0MIIjJtCXwrJOnO8UR5i5dzTG6e9yfdZeaRqYjfobME3Ox//BkmqSfuDSPPhIeYl26QEZpth3n0ahmOXSgHY+0K5HEf/6M2wEJNNoOraZnDjZ2ZaW5BsZZN9mU2kH1ircLjLvHzcflGIzDVUT3FgOzr40Gj+UZo5JvXjtakn+eqKEsKqiy2VGs2HlznwYH/MBxtZPzYyRkOXx/Fqm8f5QXpalEZD2RfGVLUOEHxuLR0mKcHTyK/kf3UNMGylpdW1IXtGTominY0nl22s+udnwYf8j7bCXbiqBBTnLnbNBPUuJa4v8tEP+RXuwIZhYuQUH/BH0byaIOeCrkz/a2kMpmlvIXvhknMt/INVHd/DesWAHc9OgQeNcCk4tU6YMkz0eL4SRDIEtwm/ygp5tc90TOjxhqi66iupm0pplMXAqpGLAPf3f7Ans3Cd5JB26S/+SS29oxxq3TYOqhp/PrKD4FvSeV3HfIVhML3jcuGx9EHvonw==
    type : 2
    code_elements :
     type_code : 3
     p_codes :
      -
        code : |1+
         // Version 1
         // Description 
         // Saisie de texte
        type : 14
      -
        type : 276
        enabled : false
      -
        type : 277
        enabled : false
      -
        type : 278
        enabled : false
 menu :
  name : _Menu
  identifier : 0x292573e513b5f221
  internal_properties : BgAAAAYAAABd4biPtdLQOwfUFiqrit8H4xfGqKyz9t6VLxCUnNZRQiLPVs82PZNE+UVdKRzjizyeuKyRur85gNMUfqplpmtNDnQWQla9zo+GH9+1EfUJ6w17Dn/egD/gv+Hhywk8c9unIdzEp7EHgaAqD28w7Agveg4u19PBcKGZtQ==
  options : []
 languages :
  - fr-FR
 popup_menus : []
 message_bar :
  internal_properties : BgAAAAYAAAA67fgqjL+BlNW0l7RVb9QHekfVEUcR8SpB62EFBVueAPYoi1/j/aXUAO/gLLyCTVuQazFai314Ui0SG0rWW0oZm0BFICoRFAhcTeX8
 code_elements :
  type_code : 1
  p_codes :
   -
     code : |1+
      PROCEDURE MaFenêtre()
      
      
      HCréationSiInexistant("*")
      
      
      gsLibFenetrePrincipale est une chaine = MoiMême..Libellé + " Version : " + ExeInfo(exeVersion)
      
      FEN_Principale..Libellé = gsLibFenetrePrincipale
      
      vAriantAnimal	est un variant
      gsCheminExcel est une chaine
      
      gsCheminFichier est une chaîne
      
      gpclMonFichierExcel est une CDocumentXls dynamique
      
      // 1 Veg 2 Animaux
      gnTypeFiche est un entier = 0
      
      
      gsDesignationFiche est une chaine
      
      
      
      
   -
     code : |1+
      
      //si SAI_Fichierencour <> "" ALORS
      //	ouvreExcel(SAI_Fichierencour)
      //FIN
      //
      //checkPolices()
      //VerifUPDATE()
      
     type : 34
   -
     type : 230
     enabled : false
  procedures :
   -
     name : hydrateVariant
     procedure_id : 2237213610828427546
     type_code : 14
     code : |1-
      // Résumé : <indiquez ici ce que fait la procédure>
      // Syntaxe :
      //hydrateVariant (<numligne1>)
      //
      // Paramètres :
      // 	numligne1 : <indiquez ici le rôle de numligne1>
      // Valeur de retour :
      // 	Aucune
      //
      // Exemple :
      // Indiquez ici un exemple d'utilisation.
      //
      procédure hydrateVariant(numligne)
      
      vAriantAnimal.nomV		= TBLR_Tableur["A" + numligne]
      vAriantAnimal.nomS		= TBLR_Tableur["B" + numligne]
      vAriantAnimal.famille	= TBLR_Tableur["C" + numligne]
      vAriantAnimal.dureeVie	= TBLR_Tableur["D" + numligne]
      vAriantAnimal.peracti	= TBLR_Tableur["E" + numligne]
      vAriantAnimal.tailleMin	= TBLR_Tableur["F" + numligne]
      vAriantAnimal.litiere	= TBLR_Tableur["G" + numligne]
      vAriantAnimal.poid		= TBLR_Tableur["H" + numligne]
      vAriantAnimal.matsex	= TBLR_Tableur["I" + numligne]
      vAriantAnimal.gestation	= TBLR_Tableur["J" + numligne]
      vAriantAnimal.portee	= TBLR_Tableur["K" + numligne]
      vAriantAnimal.maintien	= TBLR_Tableur["L" + numligne]
      vAriantAnimal.nourriture	= TBLR_Tableur["M" + numligne]
      vAriantAnimal.cout		= TBLR_Tableur["N" + numligne]
      vAriantAnimal.img		= TBLR_Tableur["O" + numligne]
     type : 458752
   -
     name : tableurVersFichier
     procedure_id : 2238723575301079640
     type_code : 14
     code : |1-
      // Résumé : <indiquez ici ce que fait la procédure>
      // Syntaxe :
      //tableurVersFichier (<nLigne> est entier)
      //
      // Paramètres :
      //	nLigne (entier) : <indiquez ici le rôle de nPage>
      // Valeur de retour :
      // 	Aucune
      //
      // Exemple :
      // Indiquez ici un exemple d'utilisation.
      //
      procédure tableurVersFichier(nLigne est un entier)
      	// vide ou cré le fichier de données
      	videfichier()
      	
      	
      	// SELON TYPE FICHE
      	selon gnTypeFiche
      		cas 1 // Végétaux
      		SELON nLigne
      			CAS 0
      				// impression de tout le catalogue Animaux
      				imprimecatalogueVEG()
      				
      			AUTRE CAS
      				// impression une seule fiche
      				SI nLigne > 1 ALORS
      					FicheVegetaux.NOM_VERNACULAIRE		= TBLR_Tableur["A" + nLigne]
      					FicheVegetaux.NOM_SCIENTIFIQUE		= TBLR_Tableur["B" + nLigne]
      					FicheVegetaux.DESCRIPTIF			= TBLR_Tableur["C" + nLigne]
      					FicheVegetaux.PER_FLO				= TBLR_Tableur["D" + nLigne]
      					FicheVegetaux.COUL_FLO				= TBLR_Tableur["E" + nLigne]
      					FicheVegetaux.TYP_FEUIL				= TBLR_Tableur["F" + nLigne]
      					FicheVegetaux.HAUTEUR				= TBLR_Tableur["G" + nLigne]
      					FicheVegetaux.ETALEMENT				= TBLR_Tableur["H" + nLigne]
      					FicheVegetaux.EXPO					= TBLR_Tableur["I" + nLigne]
      					FicheVegetaux.RUSTICITE				= TBLR_Tableur["J" + nLigne]
      					FicheVegetaux.TYPE_SOL				= TBLR_Tableur["K" + nLigne]
      					FicheVegetaux.UTILISATION			= TBLR_Tableur["L" + nLigne]
      					FicheVegetaux.PRIX					= TBLR_Tableur["M" + nLigne]
      					FicheVegetaux.IMAGE					= TBLR_Tableur["N" + nLigne]
      					
      					HAjoute(FicheVegetaux)
      				SINON
      					Info("Ligne non disponible")
      				FIN
      				
      		FIN
      			
      			
      			
      		cas 2 // Animaux
      			
      		SELON nLigne
      			CAS 0
      				// impression de tout le catalogue Animaux
      				imprimecatalogue()
      				
      			AUTRE CAS
      				// impression une seule fiche
      				SI nLigne > 1 ALORS
      					fiche.NOM_VERNACULAIRE		= TBLR_Tableur["A" + nLigne]
      					fiche.NOM_SCIENTIFIQUE		= TBLR_Tableur["B" + nLigne]
      					fiche.FAMILLE				= TBLR_Tableur["C" + nLigne]
      					fiche.DUREE_DE_VIE			= TBLR_Tableur["D" + nLigne]
      					fiche.PERIODE_ACTIVITE		= TBLR_Tableur["E" + nLigne]
      					fiche.TAILLE_MIN_HABITAT	= TBLR_Tableur["F" + nLigne]
      					fiche.LITIERE				= TBLR_Tableur["G" + nLigne]
      					fiche.POID					= TBLR_Tableur["H" + nLigne]
      					fiche.MAT_SEX				= TBLR_Tableur["I" + nLigne]
      					fiche.GESTATION				= TBLR_Tableur["J" + nLigne]
      					fiche.PORTEE				= TBLR_Tableur["K" + nLigne]
      					fiche.MAINTIEN				= TBLR_Tableur["L" + nLigne]
      					fiche.NOURRITURE			= TBLR_Tableur["M" + nLigne]
      					fiche.COUT_ANNUEL			= TBLR_Tableur["N" + nLigne]
      					fiche.IMAGE					= TBLR_Tableur["O" + nLigne]
      					HAjoute(fiche)
      				SINON
      					Info("Ligne non disponible")
      				FIN
      				
      		FIN
      		
      	CAS 3 // Animaux V2
      		
      		SELON nLigne
      			CAS 0
      				// impression de tout le catalogue Animaux
      				imprimecatalogueanimauxV2()
      				
      			AUTRE CAS
      				// impression une seule fiche
      				SI nLigne > 1 ALORS
      					FicheAnimauxV2.NOM_VERNACULAIRE		= TBLR_Tableur["A" + nLigne]
      					FicheAnimauxV2.NOM_SCIENTIFIQUE		= TBLR_Tableur["B" + nLigne]
      					FicheAnimauxV2.FAMILLE				= TBLR_Tableur["C" + nLigne]
      					FicheAnimauxV2.DUREE_DE_VIE			= TBLR_Tableur["D" + nLigne]
      					FicheAnimauxV2.PERIODE_ACTIVITE		= TBLR_Tableur["E" + nLigne]
      					FicheAnimauxV2.TAILLE_MIN_HABITAT	= TBLR_Tableur["F" + nLigne]
      					FicheAnimauxV2.LITIERE				= TBLR_Tableur["G" + nLigne]
      					FicheAnimauxV2.ORGANISATION_SOCIALE	= TBLR_Tableur["H" + nLigne]
      					FicheAnimauxV2.POID					= TBLR_Tableur["I" + nLigne]
      					FicheAnimauxV2.MAT_SEX				= TBLR_Tableur["J" + nLigne]
      					FicheAnimauxV2.GESTATION			= TBLR_Tableur["K" + nLigne]
      					FicheAnimauxV2.PORTEE				= TBLR_Tableur["L" + nLigne]
      					FicheAnimauxV2.MAINTIEN				= TBLR_Tableur["M" + nLigne]
      					FicheAnimauxV2.NOURRITURE			= TBLR_Tableur["N" + nLigne]
      					FicheAnimauxV2.COUT_ANNUEL			= TBLR_Tableur["O" + nLigne]
      					FicheAnimauxV2.IMAGE				= TBLR_Tableur["P" + nLigne]
      					HAjoute(FicheAnimauxV2)
      					
      					
      				SINON
      					Info("Ligne non disponible")
      				FIN
      				
      		FIN
      			
      		
      			
      			
      			
      		AUTRE CAS
      			info("Aucun Fichier trouvé")
      			
      	FIN
      	
      	
      	procédure interne imprimecatalogueVEG()
      	i est un entier = 2
      	
      		TANTQUE i <=1000
      			SI TBLR_Tableur["A" + i] <> "" ALORS
      				FicheVegetaux.NOM_VERNACULAIRE		= TBLR_Tableur["A" + i]
      				FicheVegetaux.NOM_SCIENTIFIQUE		= TBLR_Tableur["B" + i]
      				FicheVegetaux.DESCRIPTIF			= TBLR_Tableur["C" + i]
      				FicheVegetaux.PER_FLO				= TBLR_Tableur["D" + i]
      				FicheVegetaux.COUL_FLO				= TBLR_Tableur["E" + i]
      				FicheVegetaux.TYP_FEUIL				= TBLR_Tableur["F" + i]
      				FicheVegetaux.HAUTEUR				= TBLR_Tableur["G" + i]
      				FicheVegetaux.ETALEMENT				= TBLR_Tableur["H" + i]
      				FicheVegetaux.EXPO					= TBLR_Tableur["I" + i]
      				FicheVegetaux.RUSTICITE				= TBLR_Tableur["J" + i]
      				FicheVegetaux.TYPE_SOL				= TBLR_Tableur["K" + i]
      				FicheVegetaux.UTILISATION			= TBLR_Tableur["L" + i]
      				FicheVegetaux.PRIX					= TBLR_Tableur["M" + i]
      				FicheVegetaux.IMAGE					= TBLR_Tableur["N" + i]
      				
      				HAjoute(FicheVegetaux)
      			FIN
      			i++
      		FIN
      	FIN
      	
      
      
      
      
      
      
      procédure interne imprimecatalogue()
      		i est un entier = 2
      		
      	TANTQUE i <=1000
      		SI TBLR_Tableur["A" + i] <> "" ALORS
      			fiche.NOM_VERNACULAIRE	= TBLR_Tableur["A" + i]
      			fiche.NOM_SCIENTIFIQUE	= TBLR_Tableur["B" + i]
      			fiche.FAMILLE			= TBLR_Tableur["C" + i]
      			fiche.DUREE_DE_VIE		= TBLR_Tableur["D" + i]
      			fiche.PERIODE_ACTIVITE	= TBLR_Tableur["E" + i]
      			fiche.TAILLE_MIN_HABITAT= TBLR_Tableur["F" + i]
      			fiche.LITIERE			= TBLR_Tableur["G" + i]
      			fiche.POID				= TBLR_Tableur["H" + i]
      			fiche.MAT_SEX			= TBLR_Tableur["I" + i]
      			fiche.GESTATION			= TBLR_Tableur["J" + i]
      			fiche.PORTEE			= TBLR_Tableur["K" + i]
      			fiche.MAINTIEN			= TBLR_Tableur["L" + i]
      			fiche.NOURRITURE		= TBLR_Tableur["M" + i]
      			fiche.COUT_ANNUEL		= TBLR_Tableur["N" + i]
      			fiche.IMAGE				= TBLR_Tableur["O" + i]
      			HAjoute(fiche)
      		FIN
      		i++
      	FIN
      FIN
      
      
      procédure interne imprimecatalogueanimauxV2()
      	i est un entier = 2
      	
      	TANTQUE i <=1000
      		SI TBLR_Tableur["A" + i] <> "" ALORS
      			
      			FicheAnimauxV2.NOM_VERNACULAIRE		= TBLR_Tableur["A" + i]
      			FicheAnimauxV2.NOM_SCIENTIFIQUE		= TBLR_Tableur["B" + i]
      			FicheAnimauxV2.FAMILLE				= TBLR_Tableur["C" + i]
      			FicheAnimauxV2.DUREE_DE_VIE			= TBLR_Tableur["D" + i]
      			FicheAnimauxV2.PERIODE_ACTIVITE		= TBLR_Tableur["E" + i]
      			FicheAnimauxV2.TAILLE_MIN_HABITAT	= TBLR_Tableur["F" + i]
      			FicheAnimauxV2.LITIERE				= TBLR_Tableur["G" + i]
      			FicheAnimauxV2.ORGANISATION_SOCIALE	= TBLR_Tableur["H" + i]
      			FicheAnimauxV2.POID					= TBLR_Tableur["I" + i]
      			FicheAnimauxV2.MAT_SEX				= TBLR_Tableur["J" + i]
      			FicheAnimauxV2.GESTATION			= TBLR_Tableur["K" + i]
      			FicheAnimauxV2.PORTEE				= TBLR_Tableur["L" + i]
      			FicheAnimauxV2.MAINTIEN				= TBLR_Tableur["M" + i]
      			FicheAnimauxV2.NOURRITURE			= TBLR_Tableur["N" + i]
      			FicheAnimauxV2.COUT_ANNUEL			= TBLR_Tableur["O" + i]
      			FicheAnimauxV2.IMAGE				= TBLR_Tableur["P" + i]
      			HAjoute(FicheAnimauxV2)
      		FIN
      		i++
      	FIN
      FIN
      
      
      procédure interne videfichier()
      	HCréationSiInexistant("*")
      	HSupprimeTout(fiche)
      	HSupprimeTout(FicheVegetaux)
      	HSupprimeTout(FicheAnimauxV2)
      FIN
     type : 458752
   -
     name : chercheExcel
     procedure_id : 2239722352765344391
     type_code : 14
     code : |1+
      // Résumé : <indiquez ici ce que fait la procédure>
      // Syntaxe :
      //[ <Résultat> = ] chercheExcel ()
      //
      // Paramètres :
      //	Aucun
      // Valeur de retour :
      // 	chaîne ANSI : // 	Aucune
      //
      // Exemple :
      // Indiquez ici un exemple d'utilisation.
      //
      procédure chercheExcel() : chaîne
      
      sFichier est une chaîne
      
      // Ouvre le sélecteur de fichiers
      sFichier = fSélecteur("", "", "Sélectionnez un fichier Excel...", "Fichier Excel" + TAB + "*.xls;*.xlsx", "*.xls;*.xlsx")
      
      renvoyer sFichier
     type : 458752
   -
     name : ouvreExcel
     procedure_id : 2239722357060377708
     type_code : 14
     code : |1+
      // Résumé : <indiquez ici ce que fait la procédure>
      // Syntaxe :
      //ouvreExcel (<sChemin> est chaîne)
      //
      // Paramètres :
      //	sChemin (chaîne ANSI) : <indiquez ici le rôle de sChemin>
      // Valeur de retour :
      // 	Aucune
      //
      // Exemple :
      // Indiquez ici un exemple d'utilisation.
      //
      procédure ouvreExcel(sChemin est une chaine)
      
      TableurCharge(TBLR_Tableur,sChemin,1)
      
      gsCheminFichier = fExtraitChemin(sChemin,fDisque + fRépertoire)
      
      identifieFiche()
      
     type : 458752
   -
     name : checkPolices
     procedure_id : 2239822614481259133
     type_code : 14
     code : |1+
      // Résumé : <indiquez ici ce que fait la procédure>
      // Syntaxe :
      // checkPolices ()
      //
      // Paramètres :
      //	Aucun
      // Valeur de retour :
      // 	Aucune
      //
      // Exemple :
      // Indiquez ici un exemple d'utilisation.
      //
      procédure checkPolices()
      
      sChainePolices est une chaîne = PoliceListe()
      
      bRésultat est un booléen
      
      
      pour toute chaine sUnepolice de sChainePolices separee par RC
      	//Trace(sUnepolice)
      	si sUnepolice = "advent-Bd3" ou sUnepolice = "advent" ALORS
      		bRésultat = Vrai	
      	FIN
      FIN
      
      si bRésultat = Faux ALORS
      	si OuiNon("Voulez vous installer la police d'écriture Advent Bold 3, nécessaire à l'impression des fiches ?") ALORS
      		LanceAppliAssociée(fRepEnCours + "/advent-bd3.otf")
      		
      	FIN
      FIN
      
     type : 458752
   -
     name : identifieFiche
     procedure_id : 2261606357895417032
     type_code : 14
     code : |1-
      procédure identifieFiche()
      
      sVérificationFichier est une chaine = SansEspace(TBLR_Tableur["H1"],sscTout)
      
      
      //trace(sVérificationFichier)
      
      si TBLR_Tableur["F1"] = "TYPE DE FEUILLAGE " ALORS
      	//VEG
      	gnTypeFiche = 1
      	FEN_Principale..Libellé = gsLibFenetrePrincipale + " FICHE VEGETAUX"
      sinon
      	//ANI
      	gnTypeFiche = 2
      	FEN_Principale..Libellé = gsLibFenetrePrincipale + " FICHE ANNIMALERIE"
      FIN
      
      
      selon sVérificationFichier
      	cas "ORGANISATIONSOCIALE" // Animaux V2
      		gnTypeFiche				= 3
      		FEN_Principale..Libellé	= gsLibFenetrePrincipale + " FICHE ANIMAUX V2"
      		//trace(gnTypeFiche,FEN_Principale..Libellé)
      	AUTRE CAS
      		
      FIN
     type : 458752
  procedure_templates : []
  property_templates : []
 code_parameters :
  internal_properties : BgAAAAYAAAAwjDLmDSZ0H1P68nJIeNfqR9EvRjU/K+sVcM1T6rhVNr+VTV1mZ/rmoweYbFDZUhBGcv8UsxlDxVCOnb2U/SQOvlGWzNby3/w/V+ppSymxv+Vh
  original_name : Modele1
resources :
 string_res :
  identifier : 0x1f07ea4200029fe1
  internal_properties : BgAAAAYAAAAa2Zm8J9E/zh+/WIrVvz1fER/So3PB0gjQuxc1xKQVWY4ZDm5lfg==
custom_note :
 internal_properties : BgAAAAYAAAC68/W0/adbG0nFCRhrE42B5HRnbDzVHaz86sSQyxlBk7I=
rad :
 internal_properties : BgAAAAYAAABoAN7PLpwJW3EiA7WVZdCA5EwrCA1rvutcDHooMWKe
