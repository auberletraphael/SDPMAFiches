#To edit and compare internal_properties, use WINDEV integrated tools.
#Internal properties refer to the properties of controls in windows, reports, etc.
info :
 name : FEN_Principale
 major_version : 25
 minor_version : 0
 type : 2
 description : ""
 subtype : 0
window :
 name : FEN_Principale
 identifier : 0x2f07ea590076f92d
 internal_properties : BQAAAAUAAACv2FAEj7nOG8QwcH/jNhUDHSutikvNUH99nUhfT4aLv+l0RLa0ARgA00WKOk3Ajc3D4Y/aMQdIbpRo4jx72GfH0xJ5wLkoSL9fOqemjYEHoBmZUYDxhPFN4Cb6MGf1Rlfu60GrDbgMyXmrehheqUyXiId3uPoJnHbqIsj/ZqlZZ7Jzlmof687ntpX7xJqnD4KEs7tQ6Z6zchhR6I/ssvj+AGZ4HNVc+WNLSQbmeUNRaNYydY9v73V9kfhwyDyK+mvWgCEk6IdsX1Kd0lv8VMUEekOIVuSh4wUIJHKNNyXCvSuY/ktcISmR0F1A4ZTON67NTx1yn4mMQ/4EDkjl53JItnwOua2WSqGKXlTJnsdj2Muqy1tbWuaOLg7KwgE6mkX7e5Oj2AEkeTNX7i8419Wsm88oLaqU3iy5o3bp2WnlLdsmkUgSdbAIMNbGJaqMT7phT1ocmGWIUxlXe0JisruDq37FtHyYMi/IQJaTjHqiZ0dp6QQWB8SyOGK66YBs1yldTJRPmtSzXIprjMTHZwUbyrAW255Sdt+HRfC5PBE9CqAhHgwp29m7zCK6xQ32Uz7OZ14NEexqJiY5d8fQZAwuV6UXiY8THXZWncAjhpguDv9tLaL7HVFd8EJ9MtMM9poRdyDX+Z8ZgnQ022KQRrn44TcWxoKszQXMcJF8QSesWos=
 controls :
  -
    name : BTN_Importer
    identifier : 0x2f07eb9d0192ebc7
    internal_properties : BQAAAAUAAAC34oqepCfVn2IMMTM5sDFeIhAivET5hnhiI9OwfyhTHqEdJJnMa0HovkGj+4V06a8xzjubVhxTQgIzfKrxl+2m+ZBEUfuvqkkT6Ox8Eqa04V6noO0rRjbkOCpuzoHrwOz1OECYIQZ6y/zzDEmw7Uu5ws/xl0Ctd5Rmm+GiDthHjvXmzI1a3QvHbaB/db4kfFFM0f1SWskfPcf1WDZz1iAxaAkWZxCY0TYHL/xCxhWWYu1Gx7dfLkUiXRHOaBBk87J5eVSPQmmBE+m36nghL1XIZoMxhBOLOoKQCKfIQhhxAt8lP160QXBNGzDDR16W7hsxxxP5zKTHUzsXDKXNkRB/3/c7y7DhzHyBUBcVgaffgClxagj7woJp6fSCiH5x8Dw4P+amFJU+StovklJgTqa3ziVK4Vixs+an3lhTjXbR6iGHx+mKQOdm4NRHh5n8e4oNAZlCPhLtEPTFkU8QRB7l/4BvOJfYjZ0vfVRsl2dxBsJEG9jJfa9WGOBqDwY8KdSB/fh1+hmgqWZCgbiF5pN3SyJbfUdJWPzII/P+f5QH/lHFkuDDgruX9LPgMK4F5I/OJudkKeha+13KaDnmdSQExBip9Rd9j4QPNt9sBrF0VoWk+x1Lyj/etTmgUKDKP5v3h2IkSky0HzFVJYnbrYVRuPKx0y6w1nAIJ6q+sft7mOhQmCo0nAoZ4gvumlkPOwMvSiL4CUYQ8nkzjf39v9gXwIKKMWc/i5XbHVzxwR5cYrmYjhbaCjK0RKZRD5jHrUlq0SOmTUnWoCwY2V5kE7Q/WX1G04/yH0+1WuYlbvz2epPdoDJdwZPeweLFGtWpkCbvBRYC2YLJv9N59TsfGW+gCbrvWyMui2w99IfHAvPmBCpyUqtqe6eZyPqmLEN+xkKT
    type : 4
    code_elements :
     type_code : 4
     p_codes :
      -
        code : |1+
         // Version 1
         // Description 
         // Bouton au style Nouveau pour ajouter ou créer des éléments
         
         
        type : 14
      -
        code : |1+
         //V1
         
         //sFichier est une chaine
         //sFichier = fSélecteur("", "", "Sélectionnez un fichier Excel...", "Fichier Excel" + TAB + "*.xls;*.xlsx", "*.xls;*.xlsx")
         
         
         // TableurCharge(TBLR_Tableur,fRepEnCours() + "\fichiers\Fiche_Import_Animalerie.xlsx",1)
         
         sCheminFichier est une chaine = chercheExcel()
         
         si sCheminFichier <> "" ALORS
         	ouvreExcel(sCheminFichier)
         	SAI_Fichierencour = sCheminFichier
         FIN
         
         //V2
         //sFichier est une chaine
         //sFichier = fSélecteur("", "", "Sélectionnez un fichier Excel...", "Fichier Excel" + TAB + "*.xls;*.xlsx", "*.xls;*.xlsx")
         //
         //clMonexcel est un CDocumentXls(sFichier,TBLR_Tableur..NomComplet)
         //
         //gpclMonFichierExcel = clMonexcel
         //
         //gsCheminFichier = gpclMonFichierExcel:ouvreXls()
         //
         //SAI_Fichierencour = gsCheminFichier
         
         identifieFiche()
         
         
         
         
         
         
         
        type : 18
      -
        type : 161
        enabled : false
  -
    name : TBLR_Tableur
    identifier : 0x2f07ebbd02166627
    internal_properties : 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
    columns : []
    type : 114
    code_elements :
     type_code : 137
     p_codes :
      -
        code : |1-
         
         si SAI_Fichierencour <> "" ALORS
         	TableurSauve(TBLR_Tableur,SAI_Fichierencour,tblrEcrasementAutorisé)
         FIN
        type : 258
  -
    name : BTN_Imprimer1
    identifier : 0x2f118e7101bb8db5
    internal_properties : BQAAAAUAAAC2wp7/klWiSeADARIWJqf7nUgrPx8zYXch2SGwHTpnxpd/PbW2W607etvm70RUfA/mkk/JpWWwGr2i0uoJEvsgYqRpOdifB8WYVg3rHRu5sa2Z5ZzLtrcHd8xAADGc2i9sVEXF6kJojEyq11efPOmV+YVQA3XNhPz25eI0g7DbXHsioPbSRoW4cUg/dE071P7sji7kLgY8C5KN0wIhO+iM4oi5xP+xTrSZ4uJM/k2aB1QKsprpRwMFJ1PJcXQVX2bUDWSclFY9E0c/LfFFLZd+yIs8kaLxgfAHhLMwoe4XLQkOaAY79fdlLzpjfuy3L2B6Sxybu77kZC47Fs5Q7ScJGf6nIdqgH5T/hYJVg4o7qndrFjSjxEUTtYYaReEv9woxpVb5STfYgJvkbZfjme/QzbPMVEXkA1wav1OwOdHZsDlTKKdKzFvzP4F0iFPDiqBMWWilPBg84PMqG0iLLPqvZD4WJdrCwjGt5onK5I6eg3QttZeuJWmx9XX4tewGQqY+K5NigMFbTn8Wij3Z5sDIIUasCG0SDpRgaYM5ts/cfR+9j77R5zHaOzyAsXW6U6a33xfQozse6VhQOi/mH0If7vF9Cdfv3vDD9iRpu6eoFclZwXXBfgAZDFkHXQnYBhlCxE7SIGSYTg+bQ1TGNOInAUG0WfTgMfFbNLRm4sUubdlSEMdoMfSkT+ml4SanJqG34gZSptQzryc4OJqFej+hU8AvBGUkENVjvyeGIvVxojJRMdw4jrM0m7bTlYYVrU6B23z41qFiGGFDSJMgLI0FGh4YH1cSwJulSr/HynNN+py7sw==
    type : 4
    code_elements :
     type_code : 4
     p_codes :
      -
        code : |1+
         // Version 1
         // Description 
         // Bouton au style imprimer
         
         
        type : 14
      -
        code : |1+
         numligne est un entier
         
         nRetoursaisie est un entier = Saisie("Quelle ligne voulez vous imprimer ? Tapez 0 pour tout générer",numligne)
         
         
         selon gnTypeFiche
         	cas 1 // 1 Végétaux
         		 //info("En cours")
         		// tableur vers excel
         		tableurVersFichier(numligne)
         		
         		iDestination(iVisualisateur)
         		iImprimeEtat(ETAT_FicheVegetaux)
         		
         	cas 2 // Animaux
         		
         		// tableur vers excel
         		tableurVersFichier(numligne)
         
         		//Lancer l'ETAT_impression
         		iDestination(iVisualisateur)
         		iImprimeEtat(Catalogue_fiche,gsCheminFichier+"Images\")
         		
         	AUTRE CAS
         		
         FIN
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
        type : 18
      -
        type : 161
        enabled : false
  -
    name : BTN_Valider
    identifier : 0x2f1193a701d2e6c1
    internal_properties : BQAAAAUAAABdLVwRAefaGIaGzqUdLwtIbYz0GF7phiYExd/VvZByvk4Uwzk31wr2QdNEVIrskHTIz7D9N//zNAzuK9BiIGPirz5LHVQxsgwkaBg0VsnK57COqe482WFBLFFv2Vj7iIPISOannpRNWnSJA/iQotqvu9zNff16bvQwmcMfBpF7uVP/qgtfCEVI+bbGmVAmGnIb8pnvx5MOZ+WMGOtsDhRiq1anGnyd9vEee64hGsUKvMwmZeHSyGI0TPhe6aPWgOviHKxVYhYdiUgs8h37s0Dxedrt6MkMajrpPlQGpmdtmWpwWT3cu73wY48ZdopM7OvuKks1UiFv2rsS1akLDOouwoytrgv1ayeZ5yt4Q5u6IPGNmwWNVori0PvlQpWIiZO+DWRbXIIcRoW52O/FxVZhhMKwOk74KPeheeyF0NuEk2LUzgkGvVWQpHh4hu3cIBDlUv77QZ8evo/CrFdjr98y4bOtrN26wQrM8o7RXMONNrlRc62/lvdTZ0bkM0dfgTW5BT9yyxW3hq5DcbukhmrtyzGG3O0jn6BfoON4X/7J1IBpUKlYJ/s1G++vF99e89TupUy2nrAR71+pTE8k2WgKx+CfBqzF2gPoLiJj7Dv4Ja9fmn7UuDqdFWnIIWG21xgfGq1LHQgBnlQ1ZKteOFrAtXx1AwZwVzq5pxGsTymKhIbq0NYX1lzTtgNSKX2qeIzkbesV2r9KdT9Pf6MRpSvDa1eBFpnkJ/xpwqIr+RZCA3sRvlm/QrRqf/SOWLmitoEQgSddH5S9VqmPFJGsB9o9cECJwM0sfr8TVOKBHqeCCtgsL4Zghum5bfMnZIX/KHu5G+CjBvcRyj8muLdFpvtJJMokHJPLX9GT0dhSnC6kfEFobFS1QgRnHfXg3GCuEWVXjSBpQv3WYdiv6Gd0oaY4wMnSMLkMhteMh1EtdWzwWDnf7yR6ApGFTY2cCYnYxeGkwWrIXKhe6v+tCHdxc3pUK4nnAlkEOVq6etZk0Mj0FZtZctEhgbmezjNRFDW2fBfSAn30ydh5md3no/q9G+AOi38ndaaTqCozwsl2IRBvQtc=
    type : 4
    code_elements :
     type_code : 4
     p_codes :
      -
        code : |1+
         // Version 1
         // Description 
         // Bouton en validation
         
        type : 14
      -
        code : |1+
         tableauChaine est un tableau de chaine
         
         
         tableauChaine = TableurRécupèreSélection(TBLR_Tableur)
         sChaineUnique est une chaîne = tableauChaine[1]
         
         sChaineUnique = SansCaractère(sChaineUnique,"ABCDEFGHIJKLMNOPQRSTUVWXYZ",sscTout)
         
         numLigne est un entier = val(sChaineUnique)
         
         sNomimage est une chaîne
         
         
         si numLigne <> 0 et numLigne <> 1 ALORS
         	chainerecherche est une chaine = TBLR_Tableur["A"+numLigne]
         	sNomimage = Ouvre(FEN_Recherche_d_Image,chainerecherche,gsCheminFichier)
         sinon
         	sNomimage = Ouvre(FEN_Recherche_d_Image,"",gsCheminFichier)
         FIN
         
         si sNomimage <> "" ALORS
         	
         	// SELON LA FICHE
         	selon gnTypeFiche
         		cas 2 // Fiche Animaux
         			ajouteImage("O")
         		cas 1 // Fiche Végétaux
         			ajouteImage("N")
         		AUTRE CAS
         			
         	FIN
         	
         	
         	
         	
         	// FIN DE CAS FICHE
         	
         	
         
         	
         FIN
         
         procédure interne ajouteImage(sColonneimage est une chaine)
         	TBLR_Tableur[sColonneimage + numLigne] = sNomimage
         	// TEST
         	
         	sMonimagemin est une chaîne = ChaîneSupprime(sNomimage,".jpg")
         	
         	//trace(sMonimagemin)
         	
         	sMonimagemin += "_min.jpg"
         	
         	//trace(sMonimagemin)
         	
         	TBLR_Tableur..HauteurLigne = 200
         	
         	TableurAjouteImage(TBLR_Tableur,gsCheminFichier+"Images\" + sMonimagemin,sColonneimage + numLigne)
         	SI SAI_Fichierencour <> "" ALORS
         		TableurSauve(TBLR_Tableur,SAI_Fichierencour,tblrEcrasementAutorisé)
         		
         		
         		SI OuiNon("Voulez-vous Visualiser la fiche ?") ALORS
         			tableurVersFichier(numligne)
         			iDestination(iVisualisateur)
         			iImprimeEtat(Catalogue_fiche,gsCheminFichier+"Images\")
         		FIN
         		
         	FIN
         FIN
         
         
         //
         //pour TOUT sChaineUnique de tableauChaine
         //	info(sChaineUnique)
         //FIN
         
        type : 18
      -
        type : 161
        enabled : false
  -
    name : SAI_Fichierencour
    identifier : 0x2f15138f0220c251
    internal_properties : BQAAAAUAAACfspGFUTuxkjphWdNLxTrobl957lGlHDHAoeUfDSitnfbcM0tWx27gcBAx+90QJtKO6v8c6MulUMXOJ/1QiRsUefgy1Va1LuJ8pukLEKtJNJRcERy5Xfhqn2W1lxzuLO762/pzBzc/5qTxhoNe+xptOnimVrT6CKydWhVuNN7PzcirmIs/4wZLgwKpjmbTj4yHSNHdtzuMY/fJmaaN08VyWZj+3IwP6v7PMXIgTJ0wXxKcf28oniEuh/kuYrpedLABCudWcUQ+bpEvG2Z5X+tVJSyeCb8JSSm+R32Op9CkkbbBvj8hz0O4GjLL1v0E/KV+x/YVmQaNVTaVHXu3ocC0YE3bPkKs6RBLzIaWHHts1AZNKbLiwLQ9xNbxcweTZrHSbkMxoziBV3owHNe95yv3qwNVbXLfgdScHyJ0sg9s7O4T3p3sHZpBrlW9DOOE/xTr0zFMWWvojwhobxiHHdnbN/AT4vJXnYxtZlagmfb3r141un5lKXv8T7fUVXtIMo45fz0PKCxFynjc2OXdE/lbhFe/T+xFRJPbkpfX6cii3DYFjGMMxir78ugprwZHxo9hSUQq2QXXaUAssn0D0nCvs+8ffauX4MD2i+Vcg/AauWSMr8vq0jgUsWN0X5BagCU7ZBDxlvOTqiknQGUZ7pL3zg+fLrqlOi8nXJ/8pZhVc7azXdnzAeKN9sLRkPSbKwDUP6cRgfPDUz/xurU+d2jswGyNBWK2g2Gpqr4L67Nz3T+nhhYChVeWFzKr1rH1iTEkfYHr5d0Z97Irse1O4GQs7nUjv9mVljyR5uDhGWfbzsszHfWGNZ/Ogzi2yOeXIOehQYrtiVVs7yT6wHvT5np4Ly+mRMtVu92PaIZiJiQckrb63G4pVd6vdMnaxAD+E1OEvokCb3+bq9iyT7U2QioS234HyR1z6ZLyV8INxdc04ue0UE+UQzANMtxpTxfHIJPS6yiNK+v+r03IY2LkyWnfplQEFVOBuZ3q2JjdvaFE5Y7aFjt3Z2DwJ5ZSnlDSi1OUoykqFtlwINJoq+EfLJI5mamGVW3XdKZw5gEyiN39K+vLXOPG2438JCzIq3Ze496xaW1SRweQKGI0vKXDWv8eCRpPUV8A7VI7lspfOlP52v1pWgMbO28j9jsVYw+lQpISzAOLKWoYNRqOb0unF5RCcQeKwnN8KNV0KYloUZ7ecpM=
    type : 2
    code_elements :
     type_code : 3
     p_codes :
      -
        code : |1+
         // Version 1
         // Description 
         // Saisie de texte
        type : 14
      -
        type : 276
        enabled : false
      -
        type : 277
        enabled : false
      -
        type : 278
        enabled : false
  -
    name : BTN_SansNom1
    identifier : 0x2f5e196902137e82
    internal_properties : BQAAAAUAAACSlbJGbhQJAlM0vkOcDfrY+wM9JZI8gT4Jt825pdy/vWLdr4CZUvOP2wEjLd7pu4sgy5GLk3MAnK2el9c94wjhIvKlSLf+4bSJa1JLjGDcPYYSGOow15ZxfIaHVRH7TTZ7lhjFMYFr5WG7sclSNTm5CxVgUi3iokqrUZf1B7XD5sattphJVdsk3cjubSdyo6LWKH1y79IGj7CTYJPBsqpygHRrArSsy/N+2pvK36QeLtV2MOAyT0B9fm96CwPoPyPsj38T3/aKQP/FHZXVRoPVxkFiP79j7QmLZsRTAcqxJ9UUWTXTmuz1bhF8c1PWZFyNni4Ys6vV+P2QoLEq+6VrdcNqjB7jcJssojCInteZ+MseHUG8cYGhOCB185ngktwZ1dKOfyxRWDzB2gUllYPguu9UlQpXW8b+EMjSnjhhJRIxIDkOlidutx4/59eo6tVHcUceA5jmJDn2I8hIqJpTHvJ4URNDtum+k33JCp+jUzFh9Xcx/fX2+ntDjPcP2p8ZB4Cw7EmbsVBHG2+4ab52diqQmagoVw4XxBgegzybyyVzupVaF2leeZC2WnoWF57/MqUZ3WTWMWB98BBRgajClCrCQfnC6YpfEBJmF8pGC1/qunjvuo8AB8JjBAc2PbW5YIhNCF12ZUs4mqQVZgHN7NJ39uUWgtpjXMxOzzwNMV5CWPMxZEjWNw+gG9RmqomfAYNf2StAExFF/7SPMcMagDXzaeXiuovam5M=
    type : 4
    code_elements :
     type_code : 4
     p_codes :
      -
        code : |1+
         CImage_manager::RechercheVegetalTrefle("Bambusa ventricosa")
         
         
        type : 18
      -
        type : 161
        enabled : false
 menu :
  name : _Menu
  identifier : 0x292573e513b5f221
  internal_properties : BQAAAAUAAABd4biPtdLQOwfUFiqrit8H4xfGqKyz9t6VLxCUnNZRQiLPVs82PZNE+UVdKRzjizyeuKyRur85gNMUfqplpmtNDnQWQla9zo+GH9+1EfUJ6w17Dn/egD/gv+Hhywk8c9unIdzEp7EHgaAqD28w7Agveg4u19PBcKGZtQ==
  options : []
 languages :
  - fr-FR
 popup_menus : []
 message_bar :
  internal_properties : BQAAAAUAAABqPQh6HC8RxAVkp2SqPYLuZrfVhd+1KX4lx22hIT8uqEpE6yP7Sbc2rmVqdmL816EWzXOkEe9ijOtYwchZKAfpy3B1cNqhpJgsnbUs
 code_elements :
  type_code : 1
  p_codes :
   -
     code : |1+
      PROCEDURE MaFenêtre()
      gsLibFenetrePrincipale est une chaine = MoiMême..Libellé + " Version : " + ExeInfo(exeVersion)
      
      FEN_Principale..Libellé = gsLibFenetrePrincipale
      
      vAriantAnimal	est un variant
      gsCheminExcel est une chaine
      
      gsCheminFichier est une chaîne
      
      gpclMonFichierExcel est une CDocumentXls dynamique
      
      // 1 Veg 2 Animaux
      gnTypeFiche est un entier = 0
      
      
      gsDesignationFiche est une chaine
      
      
      
      
   -
     code : |1+
      
      si SAI_Fichierencour <> "" ALORS
      	ouvreExcel(SAI_Fichierencour)
      FIN
      
      checkPolices()
      VerifUPDATE()
      
     type : 34
   -
     type : 230
     enabled : false
  procedures :
   -
     name : hydrateVariant
     procedure_id : 2237213610828427546
     type_code : 14
     code : |1-
      // Résumé : <indiquez ici ce que fait la procédure>
      // Syntaxe :
      //hydrateVariant (<numligne1>)
      //
      // Paramètres :
      // 	numligne1 : <indiquez ici le rôle de numligne1>
      // Valeur de retour :
      // 	Aucune
      //
      // Exemple :
      // Indiquez ici un exemple d'utilisation.
      //
      procédure hydrateVariant(numligne)
      
      vAriantAnimal.nomV		= TBLR_Tableur["A" + numligne]
      vAriantAnimal.nomS		= TBLR_Tableur["B" + numligne]
      vAriantAnimal.famille	= TBLR_Tableur["C" + numligne]
      vAriantAnimal.dureeVie	= TBLR_Tableur["D" + numligne]
      vAriantAnimal.peracti	= TBLR_Tableur["E" + numligne]
      vAriantAnimal.tailleMin	= TBLR_Tableur["F" + numligne]
      vAriantAnimal.litiere	= TBLR_Tableur["G" + numligne]
      vAriantAnimal.poid		= TBLR_Tableur["H" + numligne]
      vAriantAnimal.matsex	= TBLR_Tableur["I" + numligne]
      vAriantAnimal.gestation	= TBLR_Tableur["J" + numligne]
      vAriantAnimal.portee	= TBLR_Tableur["K" + numligne]
      vAriantAnimal.maintien	= TBLR_Tableur["L" + numligne]
      vAriantAnimal.nourriture	= TBLR_Tableur["M" + numligne]
      vAriantAnimal.cout		= TBLR_Tableur["N" + numligne]
      vAriantAnimal.img		= TBLR_Tableur["O" + numligne]
     type : 458752
   -
     name : tableurVersFichier
     procedure_id : 2238723575301079640
     type_code : 14
     code : |1-
      // Résumé : <indiquez ici ce que fait la procédure>
      // Syntaxe :
      //tableurVersFichier (<nLigne> est entier)
      //
      // Paramètres :
      //	nLigne (entier) : <indiquez ici le rôle de nPage>
      // Valeur de retour :
      // 	Aucune
      //
      // Exemple :
      // Indiquez ici un exemple d'utilisation.
      //
      procédure tableurVersFichier(nLigne est un entier)
      	// vide ou cré le fichier de données
      	videfichier()
      	
      	
      	// SELON TYPE FICHE
      	selon gnTypeFiche
      		cas 1 // Végétaux
      		SELON nLigne
      			CAS 0
      				// impression de tout le catalogue Animaux
      				imprimecatalogueVEG()
      				
      			AUTRE CAS
      				// impression une seule fiche
      				SI nLigne > 1 ALORS
      					FicheVegetaux.NOM_VERNACULAIRE		= TBLR_Tableur["A" + nLigne]
      					FicheVegetaux.NOM_SCIENTIFIQUE		= TBLR_Tableur["B" + nLigne]
      					FicheVegetaux.DESCRIPTIF			= TBLR_Tableur["C" + nLigne]
      					FicheVegetaux.PER_FLO				= TBLR_Tableur["D" + nLigne]
      					FicheVegetaux.COUL_FLO				= TBLR_Tableur["E" + nLigne]
      					FicheVegetaux.TYP_FEUIL				= TBLR_Tableur["F" + nLigne]
      					FicheVegetaux.HAUTEUR				= TBLR_Tableur["G" + nLigne]
      					FicheVegetaux.ETALEMENT				= TBLR_Tableur["H" + nLigne]
      					FicheVegetaux.EXPO					= TBLR_Tableur["I" + nLigne]
      					FicheVegetaux.RUSTICITE				= TBLR_Tableur["J" + nLigne]
      					FicheVegetaux.TYPE_SOL				= TBLR_Tableur["K" + nLigne]
      					FicheVegetaux.UTILISATION			= TBLR_Tableur["L" + nLigne]
      					FicheVegetaux.PRIX					= TBLR_Tableur["M" + nLigne]
      					FicheVegetaux.IMAGE					= TBLR_Tableur["N" + nLigne]
      					
      					HAjoute(FicheVegetaux)
      				SINON
      					Info("Ligne non disponible")
      				FIN
      				
      		FIN
      			
      			
      			
      		cas 2 // Animaux
      			
      		SELON nLigne
      			CAS 0
      				// impression de tout le catalogue Animaux
      				imprimecatalogue()
      				
      			AUTRE CAS
      				// impression une seule fiche
      				SI nLigne > 1 ALORS
      					fiche.NOM_VERNACULAIRE		= TBLR_Tableur["A" + nLigne]
      					fiche.NOM_SCIENTIFIQUE		= TBLR_Tableur["B" + nLigne]
      					fiche.FAMILLE				= TBLR_Tableur["C" + nLigne]
      					fiche.DUREE_DE_VIE			= TBLR_Tableur["D" + nLigne]
      					fiche.PERIODE_ACTIVITE		= TBLR_Tableur["E" + nLigne]
      					fiche.TAILLE_MIN_HABITAT	= TBLR_Tableur["F" + nLigne]
      					fiche.LITIERE				= TBLR_Tableur["G" + nLigne]
      					fiche.POID					= TBLR_Tableur["H" + nLigne]
      					fiche.MAT_SEX				= TBLR_Tableur["I" + nLigne]
      					fiche.GESTATION				= TBLR_Tableur["J" + nLigne]
      					fiche.PORTEE				= TBLR_Tableur["K" + nLigne]
      					fiche.MAINTIEN				= TBLR_Tableur["L" + nLigne]
      					fiche.NOURRITURE			= TBLR_Tableur["M" + nLigne]
      					fiche.COUT_ANNUEL			= TBLR_Tableur["N" + nLigne]
      					fiche.IMAGE					= TBLR_Tableur["O" + nLigne]
      					HAjoute(fiche)
      				SINON
      					Info("Ligne non disponible")
      				FIN
      				
      		FIN
      			
      			
      			
      			
      			
      		AUTRE CAS
      			info("Aucun Fichier trouvé")
      			
      	FIN
      	
      	
      	procédure interne imprimecatalogueVEG()
      	i est un entier = 2
      	
      		TANTQUE i <=1000
      			SI TBLR_Tableur["A" + i] <> "" ALORS
      				FicheVegetaux.NOM_VERNACULAIRE		= TBLR_Tableur["A" + i]
      				FicheVegetaux.NOM_SCIENTIFIQUE		= TBLR_Tableur["B" + i]
      				FicheVegetaux.DESCRIPTIF			= TBLR_Tableur["C" + i]
      				FicheVegetaux.PER_FLO				= TBLR_Tableur["D" + i]
      				FicheVegetaux.COUL_FLO				= TBLR_Tableur["E" + i]
      				FicheVegetaux.TYP_FEUIL				= TBLR_Tableur["F" + i]
      				FicheVegetaux.HAUTEUR				= TBLR_Tableur["G" + i]
      				FicheVegetaux.ETALEMENT				= TBLR_Tableur["H" + i]
      				FicheVegetaux.EXPO					= TBLR_Tableur["I" + i]
      				FicheVegetaux.RUSTICITE				= TBLR_Tableur["J" + i]
      				FicheVegetaux.TYPE_SOL				= TBLR_Tableur["K" + i]
      				FicheVegetaux.UTILISATION			= TBLR_Tableur["L" + i]
      				FicheVegetaux.PRIX					= TBLR_Tableur["M" + i]
      				FicheVegetaux.IMAGE					= TBLR_Tableur["N" + i]
      				
      				HAjoute(FicheVegetaux)
      			FIN
      			i++
      		FIN
      	FIN
      	
      
      
      
      
      
      
      procédure interne imprimecatalogue()
      		i est un entier = 2
      		
      	TANTQUE i <=1000
      		SI TBLR_Tableur["A" + i] <> "" ALORS
      			fiche.NOM_VERNACULAIRE	= TBLR_Tableur["A" + i]
      			fiche.NOM_SCIENTIFIQUE	= TBLR_Tableur["B" + i]
      			fiche.FAMILLE			= TBLR_Tableur["C" + i]
      			fiche.DUREE_DE_VIE		= TBLR_Tableur["D" + i]
      			fiche.PERIODE_ACTIVITE	= TBLR_Tableur["E" + i]
      			fiche.TAILLE_MIN_HABITAT= TBLR_Tableur["F" + i]
      			fiche.LITIERE			= TBLR_Tableur["G" + i]
      			fiche.POID				= TBLR_Tableur["H" + i]
      			fiche.MAT_SEX			= TBLR_Tableur["I" + i]
      			fiche.GESTATION			= TBLR_Tableur["J" + i]
      			fiche.PORTEE			= TBLR_Tableur["K" + i]
      			fiche.MAINTIEN			= TBLR_Tableur["L" + i]
      			fiche.NOURRITURE		= TBLR_Tableur["M" + i]
      			fiche.COUT_ANNUEL		= TBLR_Tableur["N" + i]
      			fiche.IMAGE				= TBLR_Tableur["O" + i]
      			HAjoute(fiche)
      		FIN
      		i++
      	FIN
      FIN
      
      
      
      procédure interne videfichier()
      	HCréationSiInexistant("*")
      	HSupprimeTout(fiche)
      	HSupprimeTout(FicheVegetaux)
      FIN
     type : 458752
   -
     name : chercheExcel
     procedure_id : 2239722352765344391
     type_code : 14
     code : |1+
      // Résumé : <indiquez ici ce que fait la procédure>
      // Syntaxe :
      //[ <Résultat> = ] chercheExcel ()
      //
      // Paramètres :
      //	Aucun
      // Valeur de retour :
      // 	chaîne ANSI : // 	Aucune
      //
      // Exemple :
      // Indiquez ici un exemple d'utilisation.
      //
      procédure chercheExcel() : chaîne
      
      sFichier est une chaîne
      
      // Ouvre le sélecteur de fichiers
      sFichier = fSélecteur("", "", "Sélectionnez un fichier Excel...", "Fichier Excel" + TAB + "*.xls;*.xlsx", "*.xls;*.xlsx")
      
      renvoyer sFichier
     type : 458752
   -
     name : ouvreExcel
     procedure_id : 2239722357060377708
     type_code : 14
     code : |1+
      // Résumé : <indiquez ici ce que fait la procédure>
      // Syntaxe :
      //ouvreExcel (<sChemin> est chaîne)
      //
      // Paramètres :
      //	sChemin (chaîne ANSI) : <indiquez ici le rôle de sChemin>
      // Valeur de retour :
      // 	Aucune
      //
      // Exemple :
      // Indiquez ici un exemple d'utilisation.
      //
      procédure ouvreExcel(sChemin est une chaine)
      
      TableurCharge(TBLR_Tableur,sChemin,1)
      
      gsCheminFichier = fExtraitChemin(sChemin,fDisque + fRépertoire)
      
      identifieFiche()
      
     type : 458752
   -
     name : checkPolices
     procedure_id : 2239822614481259133
     type_code : 14
     code : |1+
      // Résumé : <indiquez ici ce que fait la procédure>
      // Syntaxe :
      // checkPolices ()
      //
      // Paramètres :
      //	Aucun
      // Valeur de retour :
      // 	Aucune
      //
      // Exemple :
      // Indiquez ici un exemple d'utilisation.
      //
      procédure checkPolices()
      
      sChainePolices est une chaîne = PoliceListe()
      
      bRésultat est un booléen
      
      
      pour toute chaine sUnepolice de sChainePolices separee par RC
      	//Trace(sUnepolice)
      	si sUnepolice = "advent-Bd3" ou sUnepolice = "advent" ALORS
      		bRésultat = Vrai	
      	FIN
      FIN
      
      si bRésultat = Faux ALORS
      	si OuiNon("Voulez vous installer la police d'écriture Advent Bold 3, nécessaire à l'impression des fiches ?") ALORS
      		LanceAppliAssociée(fRepEnCours + "/advent-bd3.otf")
      		
      	FIN
      FIN
      
     type : 458752
   -
     name : identifieFiche
     procedure_id : 2261606357895417032
     type_code : 14
     code : |1-
      procédure identifieFiche()
      
      //trace(TBLR_Tableur["F1"])
      
      si TBLR_Tableur["F1"] = "TYPE DE FEUILLAGE " ALORS
      	//VEG
      	gnTypeFiche = 1
      	FEN_Principale..Libellé = gsLibFenetrePrincipale + " FICHE VEGETAUX"
      sinon
      	//ANI
      	gnTypeFiche = 2
      	FEN_Principale..Libellé = gsLibFenetrePrincipale + " FICHE ANNIMALERIE"
      FIN
     type : 458752
  procedure_templates : []
  property_templates : []
 code_parameters :
  internal_properties : BQAAAAUAAAAwjDLmDSZ0H1P68nJIeNfqR9EvRjU/K+sVcM1T6rhVNr+VTV1mZ/rmoweYbFDZUhBGcv8UsxlDxVCOnb2U/SQOvlGWzNby3/w/V+ppSymxv+Vh
  original_name : Modele1
resources :
 string_res :
  identifier : 0x1f07ea4200029fe1
  internal_properties : BQAAAAUAAAAa2Zm8J9E/zh+/WIrVvz1fER/So3PB0gjQuxc1xKQVWY4ZDm5lfg==
custom_note :
 internal_properties : BQAAAAUAAAC68/W0/adbG0nFCRhrE42B5HRnbDzVHaz86sSQyxlBk7I=
rad :
 internal_properties : BQAAAAUAAABoAN7PLpwJW3EiA7WVZdCA5EwrCA1rvutcDHooMWKe
